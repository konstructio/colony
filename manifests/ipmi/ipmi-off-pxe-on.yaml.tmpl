apiVersion: bmc.tinkerbell.org/v1alpha1
kind: Job
metadata:
  name: "{{ .IP | replaceDotsWithDash }}-off-pxe-on-{{ .RandomSuffix }}"
  namespace: tinkerbell
  labels:
    colony.konstruct.io/name: "{{ .IP | replaceDotsWithDash }}"
    colony.konstruct.io/job-id: "{{ .RandomSuffix }}"
spec:
  machineRef:
    name: "{{ .IP | replaceDotsWithDash }}"
    namespace: tinkerbell
  tasks:
    - powerAction: "off"
    - oneTimeBootDeviceAction:
        device:
          - "{{ .BootDevice }}"
        efiBoot: {{ .EFIBoot }}
    - powerAction: "on"
